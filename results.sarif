{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.447", "informationUri": "https://checkov.io", "rules": [{"id": "CKV2_AWS_5", "name": "Ensure that Security Groups are attached to another resource", "shortDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "fullDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "help": {"text": "Ensure that Security Groups are attached to another resource\nResource: module.sg.aws_security_group.ec2_sg"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis"}, {"id": "CKV2_AWS_62", "name": "Ensure S3 buckets should have event notifications enabled", "shortDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "fullDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "help": {"text": "Ensure S3 buckets should have event notifications enabled\nResource: module.s3.aws_s3_bucket.replication_target_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62"}, {"id": "CKV2_AWS_64", "name": "Ensure KMS key Policy is defined", "shortDescription": {"text": "Ensure KMS key Policy is defined"}, "fullDescription": {"text": "Ensure KMS key Policy is defined"}, "help": {"text": "Ensure KMS key Policy is defined\nResource: aws_kms_key.s3_kms"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64"}, {"id": "CKV_AWS_145", "name": "Ensure that S3 buckets are encrypted with KMS by default", "shortDescription": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "fullDescription": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "help": {"text": "Ensure that S3 buckets are encrypted with KMS by default\nResource: module.s3.aws_s3_bucket.logging_target_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default"}, {"id": "CKV_AWS_144", "name": "Ensure that S3 bucket has cross-region replication enabled", "shortDescription": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "fullDescription": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "help": {"text": "Ensure that S3 bucket has cross-region replication enabled\nResource: module.s3.aws_s3_bucket.logging_target_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV2_AWS_5", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/sg/main.tf"}, "region": {"startLine": 13, "endLine": 46, "snippet": {"text": "resource \"aws_security_group\" \"ec2_sg\" {\n  name        = \"${var.env}-ec2-sg\"\n  description = \"Allow inbound traffic to EC2 instances\"\n  vpc_id      = var.vpc_id\n\n  # Ingress Rules\n  dynamic \"ingress\" {\n    for_each = local.ingress_rules\n    content {\n      description = ingress.value.description\n      from_port   = ingress.value.from_port\n      to_port     = ingress.value.to_port\n      protocol    = ingress.value.protocol\n      cidr_blocks = ingress.value.cidr_blocks\n    }\n  }\n\n  # Egress Rule (Allow all outbound)\n  egress {\n    description = \"Allow all outbound traffic\"\n    from_port   = var.egress_from_port\n    to_port     = var.egress_to_port\n    protocol    = var.egress_protocol\n    cidr_blocks = var.egress_cidr_blocks\n  }\n\n  # Tags\n  tags = merge(\n    var.tags,\n    {\n      Name = \"${var.env}-sg\"\n    }\n  )\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/s3/main.tf"}, "region": {"startLine": 151, "endLine": 160, "snippet": {"text": "resource \"aws_s3_bucket\" \"replication_target_bucket\" {\n  bucket = var.replication_target_bucket\n\n  tags = merge(\n    var.tags,\n    {\n      Name = var.replication_target_bucket\n    }\n  )\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "environments/dev/main.tf"}, "region": {"startLine": 41, "endLine": 44, "snippet": {"text": "resource \"aws_kms_key\" \"s3_kms\" {\n  description         = \"KMS key for S3 bucket and EC2 volume encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV_AWS_145", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 buckets are encrypted with KMS by default"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/s3/main.tf"}, "region": {"startLine": 300, "endLine": 309, "snippet": {"text": "resource \"aws_s3_bucket\" \"logging_target_bucket\" {\n  bucket = var.logging_target_bucket\n\n  tags = merge(\n    var.tags,\n    {\n      Name = var.logging_target_bucket\n    }\n  )\n}\n"}}}}]}, {"ruleId": "CKV_AWS_144", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has cross-region replication enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/s3/main.tf"}, "region": {"startLine": 300, "endLine": 309, "snippet": {"text": "resource \"aws_s3_bucket\" \"logging_target_bucket\" {\n  bucket = var.logging_target_bucket\n\n  tags = merge(\n    var.tags,\n    {\n      Name = var.logging_target_bucket\n    }\n  )\n}\n"}}}}]}]}]}